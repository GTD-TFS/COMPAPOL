<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>GESTOR DE PARTES Y COMPARECENCIAS ‚Äî M√≥vil</title>
<style>
  :root{
    --bg:#0a1630; --bg2:#0e224a; --panel:#0f1d44; --panel-2:#0b1a3a;
    --text:#eff3ff; --muted:#a5b3d9; --border:#203463;
    --accent:#2c6dfc; --accent-2:#45e0ff; --tape:#ffd34d; --danger:#e05b5b; --red:#ff0a0a;
    --success:#29a36a;
    --radius:16px; --shadow:0 12px 35px rgba(0,0,0,.35);
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; font-family:"Inter",system-ui,-apple-system,Segoe UI,Roboto,Arial;
    color:var(--text);
    background:
      radial-gradient(1200px 600px at -10% -10%, #182a63 0%, transparent 60%),
      radial-gradient(900px 500px at 110% -20%, #0d2e61 0%, transparent 60%),
      linear-gradient(180deg, var(--bg2), var(--bg));
  }
  .header{position:sticky; top:0; z-index:20; background:linear-gradient(180deg, rgba(10,22,48,.9), rgba(10,22,48,.75)); backdrop-filter:blur(6px); border-bottom:1px solid var(--border)}
  .header-inner{max-width:940px; margin:0 auto; padding:12px 14px; display:flex; align-items:center; gap:10px; flex-wrap:wrap;}
  .badge{
    background:repeating-linear-gradient(45deg, var(--tape), var(--tape) 10px, #1d1d1d 10px, #1d1d1d 20px);
    color:#ff0707; font-weight:900; padding:6px 10px; border-radius:10px;
    box-shadow:0 6px 18px rgba(255,211,77,.15); letter-spacing:.3px; border:1px solid rgba(0,0,0,.25);
    text-shadow:0 1px 0 rgba(0,0,0,.35);
  }
  .title{font-weight:800; font-size:16px; letter-spacing:.3px}
  .tapebar{height:6px; background:repeating-linear-gradient(135deg, var(--tape), var(--tape) 16px, #222 16px, #222 32px); border-bottom:1px solid rgba(0,0,0,.35);}
  .refresh-top{margin-left:auto; display:flex; align-items:center}
  .refresh-top button{font-size:26px; line-height:1; padding:4px 10px; border-radius:10px; border:1px solid var(--border); background:linear-gradient(180deg,#132a63,#0e224e); color:var(--text); cursor:pointer}

  .wrap{max-width:940px; margin:12px auto; padding:0 14px 18px; display:grid; grid-template-columns:1fr; gap:12px;}

  .card{background:linear-gradient(180deg, var(--panel), var(--panel-2)); border:1px solid var(--border);
    border-radius:var(--radius); box-shadow:var(--shadow); overflow:hidden;}
  .card .head{padding:12px 12px 0} .card .body{padding:12px 12px 14px}
  h2,h3{margin:0 0 8px} .muted{color:var(--muted)} .tiny{font-size:12px}

  .row{display:flex; gap:8px; flex-wrap:wrap}
  .col{flex:1 1 220px}

  label{display:block; font-size:12px; color:var(--muted); margin:2px 0 6px}
  input, select{
    width:100%; background:#0b1433; color:var(--text);
    border:1px solid var(--border); border-radius:10px;
    font:inherit; outline:none;
    height:50px; line-height:1.4; padding:12px 12px 14px;
    -webkit-appearance:none; appearance:none;
  }

  .editor{
    width:100%; min-height:70vh; line-height:1.7; outline:none; border:1px solid var(--border);
    border-radius:10px; padding:14px; background:#0b1433; overflow:auto; white-space:pre-wrap;
  }

  .btn{appearance:none; border:none; background:linear-gradient(180deg, var(--accent), #1b53d0);
    color:white; padding:10px 14px; border-radius:12px; cursor:pointer; font-weight:800; min-height:48px;
    box-shadow:0 6px 20px rgba(44,109,252,.28)}
  .btn:hover{filter:brightness(1.08)} .btn:active{transform:translateY(1px)}
  .btn.secondary{background:linear-gradient(180deg, #10224d, #0f224e); color:var(--text); border:1px solid var(--border); box-shadow:none}
  .btn.ghost{background:transparent; color:var(--muted); border:1px dashed var(--border); box-shadow:none}
  .btn.danger{background:linear-gradient(180deg, #cf4f4f, #a83e3e); box-shadow:0 6px 16px rgba(224,91,91,.25)}
  .btn.success{background:linear-gradient(180deg, var(--success), #1f7d51); box-shadow:0 6px 16px rgba(41,163,106,.25)}
  .btn.tiny{font-size:13px; padding:7px 10px; border-radius:9px; min-height:auto}
  .btn-row{display:flex; gap:8px; flex-wrap:wrap}

  .btn-grid{
    display:grid;
    grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
    gap:8px;
    align-items:stretch;
  }
  .btn-grid .btn{width:100%}

  .fmtbar{
    display:flex;
    gap:6px;
    margin:6px 0 8px;
    justify-content:flex-end;
    flex-wrap:wrap;
  }
  .fmtbar button{
    min-height:auto;
    padding:6px 8px;
    border-radius:8px;
  }
.fmtbar .active{
  filter: brightness(1.2);
  box-shadow: 0 0 0 2px rgba(255,255,255,.12) inset;
}
  .modal{ position:fixed; inset:0; background:rgba(0,0,0,.55); display:none; align-items:center; justify-content:center; z-index:9999; }
.modal.show{ display:flex; }
.fmtbar .active{ filter:brightness(1.2); box-shadow:0 0 0 2px rgba(255,255,255,.12) inset; }

  details{background:#0c1640; border:1px solid var(--border); border-radius:12px; margin-bottom:10px; overflow:hidden;}
  summary{list-style:none; position:relative; padding:10px 44px 10px 10px; cursor:pointer; user-select:none; display:flex; align-items:center; gap:10px; min-height:40px;}
  summary::-webkit-details-marker{display:none}
  .tag{font-size:12px; color:#08122a; background:linear-gradient(180deg, var(--accent-2), #1c8ba5); padding:3px 8px; border-radius:999px; font-weight:900; border:1px solid rgba(8,18,42,.3)}
  .title{font-weight:800}
  .sub{font-size:12px; color:#b6c5ff}
  .summary-right{margin-left:auto; display:flex; align-items:center; gap:8px}
  .docmeta{font-size:12px; color:#b6c5ff; white-space:nowrap}
  .caret{margin-left:6px; width:14px; height:14px; border:solid #7fb7ff; border-width:0 2px 2px 0; display:inline-block; padding:3px; transform:rotate(0deg); transition:transform .2s ease;}
  details[open] summary .caret{transform:rotate(45deg)}
  .details-body{padding:10px; border-top:1px solid var(--border); background:linear-gradient(180deg,#0b1537,#0a1333)}

  .req{color:#ffb3b3}
</style>
</head>
<body>
<header class="header">
  <div class="tapebar"></div>
  <div class="header-inner">
    <div class="badge">COMPA ‚Ä¢ POL</div>
    <div class="title">GESTOR DE PARTES Y COMPARECENCIAS ‚Äî M√≥vil</div>
    <div class="refresh-top"><button id="refreshTopBtn" title="Comenzar nuevo (borra todo)">üîÑ</button></div>
  </div>
</header>

<div class="wrap">

  <!-- Panel: Documento (botones arriba) -->
  <section class="card" id="panel-documento">
    <div class="head">
      <div class="btn-grid">
        <button class="btn secondary" id="saveProjectBtn">üíº Guardar proyecto</button>
        <input type="file" id="loadProjectInput" accept="application/json" style="display:none" />
        <button class="btn secondary" id="loadProjectBtn">üìÇ Cargar proyecto</button>
        <button class="btn secondary" id="printBtn">üñ®Ô∏è Imprimir / PDF</button>
      </div>
    </div>
  </section>

  <!-- Filiaciones (entre botones y t√≠tulo) -->
  <section class="card" id="panel-filiaciones">
    <div class="head"><h2>Filiaciones</h2></div>
    <div class="body">
      <div class="btn-row" style="margin-bottom:10px">
  <button class="btn" id="addFBtn">‚ûï A√±adir filiaci√≥n</button>
  <button class="btn secondary" id="importXlsxBtn">üì• Importar XLSX</button>
  <input id="importXlsxInput" type="file" accept=".xlsx,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" multiple style="display:none" />
  <button class="btn secondary" id="importJsonBtn">üì• Importar JSON</button>
  <input id="importJsonInput" type="file" accept="application/json" multiple style="display:none" />
</div>

      <div id="filiaciones"></div>
      <p id="emptyHint" class="muted tiny" style="display:none">No hay filiaciones. Importa un XLSX o pulsa ‚ÄúA√±adir filiaci√≥n‚Äù.</p>
    </div>
  </section>

  <!-- Continuaci√≥n del documento: t√≠tulo + editor -->
  <section class="card">
    <div class="body">
      <label for="titulo">T√≠tulo</label>
      <input id="titulo" />
      <div class="fmtbar">
        <button class="btn secondary tiny" id="boldBtn" title="Negrita"><strong>B</strong></button>
        <button class="btn secondary tiny" id="italicBtn" title="Cursiva"><em>I</em></button>
        <button class="btn secondary tiny" id="underBtn" title="Subrayado"><span style="text-decoration:underline">U</span></button>
        <button class="btn secondary tiny" id="openColetillasBtn" title="Coletillas">üß©</button>
      </div>
      <label for="doc">Contenido</label>
      <div id="doc" class="editor" contenteditable="true"></div>
      <p class="tiny muted">Atajos: <strong>fN / FN</strong> inserta filiaci√≥n N, <strong>ccc</strong> abre Coletillas.</p>
    </div>
  </section>

</div>

<!-- Modal Coletillas -->
<div class="modal" id="coletillasModal" aria-hidden="true">
  <div class="panel" role="dialog" aria-modal="true" aria-labelledby="coletillasTitle">
    <div class="head">
      <strong id="coletillasTitle">Coletillas predeterminadas</strong>
      <button class="btn ghost tiny" id="closeColetillasBtn">‚úï Cerrar</button>
    </div>
    <div class="body">
      <div class="coletillas" id="coletillasList"></div>
    </div>
  </div>
</div>

<script defer src="core.js"></script>
<script defer src="ui.js"></script>
<script defer src="io.js"></script>

</body>
</html>




